# ブックマーク管理AIエージェント 要件定義書

**作成日:** 2025年1月7日  
**プロジェクト名:** 汎用ブックマーク管理・レコメンドシステム  
**対象ユーザー:** 個人利用（作成者のみ）

---

## 1. プロジェクト概要

### 1.1 目的

Webブラウジング中にブックマークした記事を一元管理し、適切なタイミングで再訪を促すことで、情報のインプットと活用を効率化する。

### 1.2 背景

- 技術記事やブログ記事をブックマークしても、読み返す機会が少ない
- ブックマークが蓄積されても整理されず、検索性が低い
- なぜブックマークしたのか、後から思い出せない

### 1.3 解決する課題

- ブックマーク時の意図を記録し、後から文脈を復元可能にする
- AIによる自動タグ付けで整理を自動化する
- 定期的なリマインドで、保存した情報を活用する機会を創出する

---

## 2. システム構成

### 2.1 技術スタック


| コンポーネント | 技術                       | 役割         |
| ------- | ------------------------ | ---------- |
| フロントエンド | Chrome拡張機能 (Manifest V3) | ブックマーク登録UI |
| バックエンド  | n8n                      | ワークフロー自動化  |
| データベース  | Notion Database          | データ永続化・管理  |
| AI処理    | OpenAI API (GPT-4o-mini) | タグ付け・要約    |
| 通知      | Slack                    | レコメンド配信    |


### 2.2 システム構成図

```
[Webページ閲覧中]
    ↓
[Chrome拡張機能] 
 - メタデータ抽出
 - ユーザーメモ入力
    ↓
[n8n Webhook受信]
    ↓
[OpenAI API] → タグ付け処理
    ↓
[Notion Database] → データ保存
    ↓
[n8n定期実行 (週1回)]
    ↓
[Slack通知] → レコメンド配信
```

---

## 3. 機能要件

### 3.1 ブックマーク登録機能

#### 3.1.1 基本機能

- **トリガー:** Chrome拡張機能のアイコンクリック（任意のWebページ上で実行可能）
- **取得データ:**
  - URL（必須）
  - ページタイトル（必須）
  - メタディスクリプション（任意）
  - OGP画像URL（任意）
  - サイト名（OGPから取得、任意）
  - ドメイン名（URLから抽出）
  - ブックマーク日時（自動記録）

#### 3.1.2 ユーザー入力項目

- **ブックマーク理由:** 10〜20文字のテキスト入力（必須）
  - 例: 「プロンプトエンジニアリングの参考に」
  - 例: 「後で実装する予定」

#### 3.1.3 データ取得優先順位

1. Open Graph Protocol (OGP) タグ
2. Twitter Card メタタグ
3. 標準HTMLメタタグ（description, keywords等）
4. ページタイトル + URL（最低限の情報）

### 3.2 自動タグ付け機能

#### 3.2.1 処理フロー

1. n8nがブックマークデータを受信
2. OpenAI APIに以下を送信:
  - タイトル
  - メタディスクリプション
  - ユーザーメモ
3. LLMが3〜5個のタグを生成
4. タグと共にNotionへ保存

#### 3.2.2 タグ候補（事前定義）

- 技術系: AI, プログラミング, インフラ, セキュリティ, データ分析
- ビジネス系: キャリア, マーケティング, 起業, マネジメント
- デザイン系: UI/UX, デザイン思考, グラフィック
- 学習系: 学習方法, チュートリアル, ドキュメント
- その他: ライフハック, エッセイ, ニュース

#### 3.2.3 タグ付けロジック

- メタデータのみをLLMに渡す（本文スクレイピングは行わない）
- ユーザーメモを重視した文脈理解
- 後からNotionで手動修正可能

### 3.3 データ管理機能

#### 3.3.1 Notionデータベーススキーマ


| プロパティ名         | 型       | 説明                 |
| -------------- | ------- | ------------------ |
| Title          | タイトル    | 記事タイトル             |
| URL            | URL     | 記事URL（重複防止のユニークキー） |
| Description    | テキスト    | メタディスクリプション        |
| User Memo      | テキスト    | ブックマーク理由（ユーザー入力）   |
| Tags           | マルチセレクト | 自動生成タグ             |
| Site Name      | セレクト    | サイト名（Zenn, Qiita等） |
| Domain         | テキスト    | ドメイン名              |
| OG Image       | URL     | OGP画像              |
| Bookmarked At  | 日付      | ブックマーク登録日時         |
| Last Reminded  | 日付      | 最終リマインド日時          |
| Reminder Count | 数値      | リマインド回数            |


#### 3.3.2 データ保存ルール

- URL重複チェックを実施（同じ記事の重複登録を防止）
- メタデータ取得失敗時も、タイトルとURLは必ず保存
- メタデータ不足フラグを立てて後で確認可能にする

### 3.4 レコメンド通知機能

#### 3.4.1 実行タイミング

- **頻度:** 週1回（毎週日曜日 9:00を推奨）
- **実装:** n8nのスケジュール機能

#### 3.4.2 レコメンドロジック（MVP版）

以下の条件を満たす記事から3〜5件を選択:

1. ブックマークから7日以上経過
2. リマインド回数が3回未満
3. 最終リマインドから7日以上経過

**選択方法:**

- タグの多様性を考慮（偏りを避ける）
- ランダム要素を含める
- 古い順に優先度を上げる

#### 3.4.3 通知内容（Slack）

```
📚 今週のおすすめブックマーク

1. [記事タイトル]
   🏷️ タグ: AI, プログラミング
   📝 メモ: プロンプトエンジニアリングの参考に
   🔗 https://example.com/article
   📅 2024年12月15日にブックマーク

2. [記事タイトル]
   ...

---
💡 合計XXX件のブックマークを管理中
```

---

## 4. 非機能要件

### 4.1 パフォーマンス

- ブックマーク登録: 3秒以内に完了
- タグ付け処理: 10秒以内に完了
- Slack通知: 1分以内に配信

### 4.2 セキュリティ

- n8n Webhook URLは環境変数で管理
- OpenAI APIキーはn8n内で安全に保管
- ユーザー個人のデータのみ扱う（他者との共有なし）

### 4.3 拡張性

- 新しいサイトへの対応は不要（URL汎用方式）
- タグ候補は後から追加・変更可能
- 通知先をLINEに変更可能な設計

### 4.4 保守性

- Chrome拡張機能はManifest V3準拠
- n8nワークフローはバージョン管理可能な形式でエクスポート
- Notionスキーマ変更時の影響範囲を最小化

---

## 5. 制約事項

### 5.1 技術的制約

- メタデータが存在しないページは情報取得が限定的
- ログイン必要なページはブラウザ上でアクセス済みの状態が前提
- OGP画像が存在しない場合は画像なしで保存

### 5.2 コスト制約

- OpenAI API利用料: 月額$5以内を目標
- n8n: セルフホスト（無料）またはクラウド版（$20/月）
- Notion: 無料プラン内で運用

### 5.3 スコープ外

以下は初期バージョンでは実装しない:

- リアルタイムでのいいね数・ブックマーク数更新
- 記事本文の全文保存
- 複数ユーザー対応
- モバイルアプリ対応
- 統計ダッシュボード

---

## 6. 開発フェーズ

### フェーズ1: MVP（最小実装）

**目標期間:** 2〜3週間

**実装内容:**

1. Chrome拡張機能の基本実装
  - メタデータ抽出機能
  - ユーザーメモ入力UI
  - n8n Webhook送信
2. n8nワークフロー構築
  - Webhook受信
  - OpenAI API連携
  - Notion保存
3. 定期レコメンド機能
  - 週1回のSlack通知
  - シンプルなレコメンドロジック

**成功基準:**

- 任意のWebページでブックマーク登録が可能
- 自動タグ付けが正常に動作
- 週1回のSlack通知が届く

### フェーズ2: 機能改善

**目標期間:** 1〜2週間

**実装内容:**

1. レコメンドロジックの改善
  - タグの多様性を考慮
  - ユーザーの閲覧傾向を学習
2. Notion UI改善
  - テンプレート作成
  - ビュー設定（タグ別、日付別等）
3. エラーハンドリング強化
  - メタデータ取得失敗時の処理
  - リトライ機構

### フェーズ3: 拡張機能

**目標期間:** 必要に応じて

**実装内容:**

- 統計情報の可視化
- 通知内容のパーソナライズ
- LINE通知対応
- 過去のブックマーク検索機能

---

## 7. リスクと対策


| リスク                | 影響度 | 対策                            |
| ------------------ | --- | ----------------------------- |
| メタデータが取得できないサイトが多い | 中   | 最低限タイトルとURLで保存、手動タグ付けで補完      |
| OpenAI APIのコスト超過   | 低   | トークン使用量を監視、必要に応じてモデル変更        |
| n8nの稼働停止           | 中   | セルフホストの場合は監視設定、クラウド版への移行検討    |
| Chrome拡張機能の審査却下    | 低   | 個人利用のため公開不要、ローカルインストールで運用     |
| Notion無料プランの容量制限   | 低   | データ量を定期的に確認、必要に応じて古いデータをアーカイブ |


---

## 8. 成功指標（KPI）

### 定量指標

- 月間ブックマーク登録数: 20件以上
- タグ付け精度（手動修正率）: 80%以上
- レコメンド通知のクリック率: 30%以上
- システム稼働率: 95%以上

### 定性指標

- ブックマークした記事を後から活用できている実感
- 情報整理の手間が削減された実感
- 学習効率の向上

---

## 9. 付録

### 9.1 参考情報

- Chrome拡張機能 Manifest V3: [https://developer.chrome.com/docs/extensions/mv3/](https://developer.chrome.com/docs/extensions/mv3/)
- n8n公式ドキュメント: [https://docs.n8n.io/](https://docs.n8n.io/)
- Notion API: [https://developers.notion.com/](https://developers.notion.com/)
- OpenAI API: [https://platform.openai.com/docs/](https://platform.openai.com/docs/)

### 9.2 用語集

- **OGP (Open Graph Protocol):** WebページのメタデータをSNS等で共有しやすくする規格
- **メタタグ:** HTML内に記述される、ページの情報を表すタグ
- **Webhook:** HTTPリクエストによってイベントを通知する仕組み
- **Manifest V3:** Chromeの最新拡張機能仕様（V2は2024年廃止）

---

**承認者:** Mei  
**最終更新日:** 2025年1月7日